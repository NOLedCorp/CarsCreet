<div class="container" [ngClass] = "{'show':(showMess && !showAll && !userProfile),'ProfileShow':(showMess && userProfile), 'showP':(showMess && userProfile), 'InPage':showAll, 'Profile':userProfile}">
  
  <div class="header" [ngClass]="{'hidden-header':(showMess && userProfile)}" (click)="show(showAll)">
    <i class="fa fa-comments" ></i>
    <h3 *ngIf="!userProfile">{{'SEND_MESSAGE' | translate}}</h3>
    
  </div>
  <form [formGroup]="messageForm" *ngIf="!userProfile">
    <div class="item">
      <span [ngClass]="{ 'is-invalid': submitted && f.Name.errors }">{{'NAME' | translate }}</span>
      <input formControlName="Name" type="text">
      <div *ngIf="submitted && f.Name.errors" class="invalid-feedback">
        <span class="d-block is-invalid" *ngIf="f.Name.errors.required">{{"NAME_VALIDATION" | translate}}</span>
    
      </div>
    </div>
    <div class="item">
      <span [ngClass]="{ 'is-invalid': submitted && f.Email.errors }">{{'EMAIL' | translate }}*</span>
      <input formControlName="Email" type="email">
      <div *ngIf="submitted && f.Email.errors" class="invalid-feedback">
        <span class="d-block is-invalid" *ngIf="f.Email.errors.required">{{"EMAIL_VALIDATION" | translate}}</span>
  
      </div>
    </div>
    <div class="item">
      <span [ngClass]="{ 'is-invalid': submitted && f.Message.errors }">{{'MESSAGE' | translate }}*</span>
      <textarea formControlName="Message" cols="30" rows="4"></textarea>
      <div *ngIf="submitted && f.Message.errors" class="invalid-feedback">
        <span class="d-block is-invalid" *ngIf="f.Message.errors.required">{{"MESSAGE_VALIDATION" | translate}}</span>
    
      </div>

    </div>
    <button class="btn btn-primary" (click)="send()">{{'SEND' | translate }}</button>
  </form>
  <div class="topic top-topic" (click) = "showTopic()"  *ngIf="userProfile && (!!currentTopic)">
    <div class="row">
      <div class="col-sm-7"><span>{{currentTopic.User.Name}}</span></div>
      <div class="col-sm-5"><span>{{currentTopic.ModifyDate | date: 'HH:mm'}}</span></div>
    </div>
  </div>
  <div *ngIf="userProfile && (!!currentTopic)" class="panel">
    <textarea #message></textarea>
    <i class="fa fa-paper-plane" (click)="sendMessage(message)"></i>
  </div>
  <div *ngIf="userProfile && topics.length==0" class="panel">
    <button class="btn btn-default" (click)="CreateTopic()">Написать</button>
  </div>
  <div *ngIf=" userProfile" class="messages">
    <div *ngIf="topics.length==0 && userProfile" class="no-message">
      <span><span>{{'NO_DATA_MESSAGER' | translate }}</span></span>
    </div>
    <div class="topic" [ngClass]="{'hidden':!!currentTopic}" (click) = "showTopic(top)"  *ngFor="let top of topics">
      <div class="row">
        <div class="col-sm-7"><span>{{top.User.Name}}</span></div>
        <div class="col-sm-5"><span>{{top.ModifyDate | date: 'HH:mm'}}</span></div>
      </div>
    </div>
    <div  class="message" [ngClass]="{'my-message': mes.UserId == userId}" *ngFor="let mes of currentTopic?currentTopic.Messages:[]">
      <div class="message-body">
        
        <p>{{mes.Text}}</p>
        <span>{{mes.CreateDate | date: 'HH:mm'}}</span>
      </div>
    </div>
  </div>
  
</div>
<div *ngIf="showMess" style="background-color: transparent"  [ngClass] = "{'blurProf':userProfile}" class="background-blur" (click)="show(showAll)"></div>
<div *ngIf="userProfile" style="z-index: 310" class="header-small"  (click)="show(showAll)">
  <i class="fa fa-comments" ></i>
</div>
<div *ngIf="!userProfile && !showAll" [ngClass]="{'hidden-header':showMess}" class="header-small"  (click)="show(showAll)">
  <i class="fa fa-comments" ></i>
</div>